---
layout: post
title: 架构_Web高可用架构
date: 2021-12-16 21:00:00 +0800
categories: 服务端
tag: 架构
---

### 零. 核心问题

1. 网站可用性如何衡量？
	- 指标
	- 考核

2. 如何设计高可用的系统？
	- 冗余
	- 失效转移

### 一. 网站可用性的衡量

***

#### 1. 可用性度量
- 9的多少数量来衡量
	- 90% 小于36天12小时
	- 99% 小于87小时36分钟
	- 99.9% 小于8小时46分钟
	- 99.99% 小于52分钟33秒
	- 99.999% 小于5分钟15秒
	- 99.9999% 小于31.5秒

***

#### 2. 可用性考核
- 数据和服务的冗余备份
	-
- 数据和服务的失效转移
	- 

### 二. 高可用的应用

*** 
#### 1. 负载均衡进行无状态服务的失效转移
- 无状态，实现所有服务器完全对等
- 失效转移，某一个出现问题能够及时剔除

*** 
#### 2. 应用服务器集群的Session管理
- 业务总是有状态的
- Session,多次请求使用的上下文对象
	 1. Session复制
	 	- 每台都备份一份：空间/带宽浪费较多
	 2. Session绑定
	 	- 通过负载均衡将请求分发到同一台服务器
	 	- 一旦宕机就会导致无法完成业务处理
	 3. 利用Cookie存储Session
	 	- Cookie大小受限
	 	- 传输耗费性能
	 	- 浏览区关闭Cookie会导致不可用
	 4. Session服务器
	 	- Session服务集群统一管理Session

### 三. 高可用的服务

*** 
#### 1. 分级管理
- 服务分级管理
	- 核心应用和服务使用更好的配置
- 服务部署隔离
	- 避免故障的连锁反应

*** 
#### 2. 超时设置
- 由于服务失去响应导致用户请求长时间得不到响应
	- 同时还占用资源
	- 设置超时时间
***
#### 3. 异步调用
- 通过消息队列等异步方式，避免一个服务失败导致整个过程失败
	- 
*** 
#### 4. 服务降级
- 访问高峰，服务因大量并发而性能下降，为保证核心应用和功能的正常运行
	- 拒绝服务
		- 拒绝低优先级应用的调用
		- 减少服务调用并发数
	- 关闭功能
		- 关闭部分不重要的服务
		- 节约系统开销，为重要的服务和功能让出资源

*** 
#### 5. 幂等性设计
- 服务重复调用和调用一次产生的结果相同
	- 解决服务重复调用问题


### 四. 高可用的数据

*** 
#### 1. CAP原理
- C: Consistency
	- 数据一致性
	- 
- A: Availability
	- 数据可用性
	- 
- P: Partition Tolerance
	- 分区耐受性
	- 

*** 
#### 2. 数据备份

*** 
#### 3. 失效转移



### 五. 高可用软件质量保证



